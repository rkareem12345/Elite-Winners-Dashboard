<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winners Gallery - Desktop Display</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;700&family=Audiowide&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: #000;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Animated background */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at 20% 80%, #120458 0%, transparent 50%),
                       radial-gradient(circle at 80% 20%, #1e0a3c 0%, transparent 50%),
                       linear-gradient(135deg, #000 0%, #0a0a0a 100%);
            z-index: 1;
        }

        /* Animated grid overlay */
        .grid-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0, 255, 255, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 255, 0.02) 1px, transparent 1px);
            background-size: 100px 100px;
            z-index: 2;
            animation: gridFloat 8s ease-in-out infinite;
        }

        @keyframes gridFloat {
            0%, 100% { opacity: 0.3; transform: translateY(0); }
            50% { opacity: 0.1; transform: translateY(-10px); }
        }

        /* Main container */
        .gallery-container {
            position: relative;
            z-index: 10;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* Title */
        .title {
            font-family: 'Audiowide', cursive;
            font-size: 4rem;
            color: #fff;
            text-align: center;
            margin-bottom: 3rem;
            text-transform: uppercase;
            letter-spacing: 0.3em;
            text-shadow: 0 0 30px rgba(255, 255, 255, 0.8);
            animation: titlePulse 3s ease-in-out infinite;
        }

        @keyframes titlePulse {
            0%, 100% { 
                text-shadow: 0 0 30px rgba(255, 255, 255, 0.8); 
                transform: scale(1);
            }
            50% { 
                text-shadow: 0 0 50px rgba(0, 255, 255, 1), 0 0 80px rgba(255, 255, 255, 0.6); 
                transform: scale(1.02);
            }
        }

        /* Media display area */
        .media-display {
            width: 85vw;
            height: 70vh;
            position: relative;
            border-radius: 20px;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            box-shadow: 
                0 30px 60px rgba(0, 0, 0, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            animation: mediaEntry 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            opacity: 0;
            transform: translateY(100px) scale(0.9);
        }

        @keyframes mediaEntry {
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        /* Holographic border */
        .media-display::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, #00ffff, #ff0080, #8000ff, #00ff80, #ffff00, #00ffff);
            background-size: 400% 400%;
            border-radius: 20px;
            z-index: -1;
            animation: holoBorder 6s ease infinite;
            opacity: 0.7;
        }

        @keyframes holoBorder {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 100% 100%; }
            75% { background-position: 0% 100%; }
        }

        /* Media elements */
        .media-item {
            width: 100%;
            height: 100%;
            object-fit: contain; /* Changed from cover to contain to show full image */
            border-radius: 20px;
            transition: all 0.8s ease;
            opacity: 0;
            transform: scale(1.1);
            background: rgba(0, 0, 0, 0.3); /* Background for letterboxing */
        }

        .media-item.active {
            opacity: 1;
            transform: scale(1);
        }

        .media-item.fade-out {
            opacity: 0;
            transform: scale(0.95);
        }

        /* Video specific styles */
        video.media-item {
            object-fit: contain; /* Changed to contain for videos too */
        }

        /* Alternative styling for cover mode - uncomment if you want to crop images */
        /*
        .media-item {
            object-fit: cover;
        }
        */

        /* Progress indicator */
        .progress-container {
            position: absolute;
            bottom: 3rem;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
            gap: 2rem;
            background: rgba(0, 0, 0, 0.5);
            padding: 1rem 2rem;
            border-radius: 50px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .progress-bar {
            width: 400px;
            height: 6px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ffff, #ff0080, #8000ff);
            border-radius: 3px;
            width: 0%;
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.6);
            transition: width 0.1s ease;
        }

        .progress-text {
            color: #00ffff;
            font-size: 1.2rem;
            font-weight: 600;
            min-width: 120px;
            text-align: center;
        }

        /* Media type indicator */
        .media-type {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: rgba(0, 0, 0, 0.7);
            color: #00ffff;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            text-transform: uppercase;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 255, 0.3);
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .media-display {
                width: 90vw;
                height: 65vh;
            }
            
            .title {
                font-size: 3rem;
                margin-bottom: 2rem;
            }
            
            .progress-bar {
                width: 300px;
            }
        }

        /* Loading animation */
        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 20px;
            backdrop-filter: blur(10px);
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(0, 255, 255, 0.3);
            border-top: 4px solid #00ffff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Background layers -->
    <div class="background"></div>
    <div class="grid-overlay"></div>

    <div class="gallery-container">
        <!-- Title -->
        <h1 class="title">Winners Gallery</h1>

        <!-- Media display -->
        <div class="media-display" id="mediaDisplay">
            <div class="loading-overlay" id="loadingOverlay">
                <div class="loading-spinner"></div>
            </div>
            <div class="media-type" id="mediaType">Image</div>
        </div>

        <!-- Progress indicator -->
        <div class="progress-container">
            <span class="progress-text">Next in:</span>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <span class="progress-text" id="countdown">10s</span>
        </div>
    </div>

    <script>
        // AUTO-DETECTION SYSTEM - Multiple methods to find media
        
        // CONFIGURATION - Choose your method:
        const CONFIG = {
            // Method 1: Google Drive Folder (requires setup)
            googleDriveFolder: {
                enabled: false, // Set to true to use Google Drive
                folderId: "1PFvkmW5p4ztuGWKA8ZmhBkS_wWFHuawc", // Your folder ID
                apiKey: "YOUR_GOOGLE_API_KEY" // Get from Google Cloud Console
            },
            
            // Method 2: Online folder/URL list
            onlineFolder: {
                enabled: false, // Set to true to use online URLs
                baseUrl: "https://your-server.com/images/", // Your image server
                fileList: ["image1.jpg", "image2.jpg", "image3.jpg"] // List your files
            },
            
            // Method 3: Manual URL list (backup)
            manualUrls: [
                // Add your direct image URLs here as fallback
                "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=800&h=800&fit=crop",
                "https://images.unsplash.com/photo-1494790108755-2616b612b786?w=800&h=800&fit=crop"
            ]
        };
        
        let mediaFiles = [];
        let currentIndex = 0;
        let countdownTimer;
        let progressTimer;
        let currentMediaElement = null;
        let isTransitioning = false;
        const displayDuration = 10000; // 10 seconds

        // DOM elements
        const mediaDisplay = document.getElementById('mediaDisplay');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const mediaType = document.getElementById('mediaType');
        const progressFill = document.getElementById('progressFill');
        const countdown = document.getElementById('countdown');

        // Google Drive API integration
        async function getGoogleDriveFiles(folderId, apiKey) {
            try {
                console.log('Fetching Google Drive files...');
                const url = `https://www.googleapis.com/drive/v3/files?q='${folderId}'+in+parents&fields=files(id,name,mimeType)&key=${apiKey}`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                if (!response.ok) {
                    throw new Error(data.error?.message || 'Failed to fetch Google Drive files');
                }
                
                const imageFiles = data.files.filter(file => 
                    file.mimeType.startsWith('image/') || file.mimeType.startsWith('video/')
                );
                
                console.log(`Found ${imageFiles.length} media files in Google Drive`);
                
                return imageFiles.map(file => 
                    `https://drive.google.com/uc?export=view&id=${file.id}`
                );
                
            } catch (error) {
                console.error('Google Drive API error:', error);
                throw error;
            }
        }

        // Auto-detect local images in folder
        async function autoDetectLocalMedia() {
            console.log('Starting local auto-detection...');
            
            // Common image and video file names to check
            const commonNames = [
                // Images
                'image1.jpg', 'image2.jpg', 'image3.jpg', 'image4.jpg', 'image5.jpg',
                'photo1.jpg', 'photo2.jpg', 'photo3.jpg', 'photo4.jpg', 'photo5.jpg',
                'winner1.jpg', 'winner2.jpg', 'winner3.jpg', 'winner4.jpg', 'winner5.jpg',
                'img1.jpg', 'img2.jpg', 'img3.jpg', 'img4.jpg', 'img5.jpg',
                'pic1.jpg', 'pic2.jpg', 'pic3.jpg', 'pic4.jpg', 'pic5.jpg',
                
                // PNG versions
                'image1.png', 'image2.png', 'image3.png', 'image4.png', 'image5.png',
                'photo1.png', 'photo2.png', 'photo3.png', 'photo4.png', 'photo5.png',
                'winner1.png', 'winner2.png', 'winner3.png', 'winner4.png', 'winner5.png',
                
                // Videos
                'video1.mp4', 'video2.mp4', 'video3.mp4', 'video4.mp4', 'video5.mp4',
                'movie1.mp4', 'movie2.mp4', 'movie3.mp4',
                
                // More numbers
                'image6.jpg', 'image7.jpg', 'image8.jpg', 'image9.jpg', 'image10.jpg',
                'photo6.jpg', 'photo7.jpg', 'photo8.jpg', 'photo9.jpg', 'photo10.jpg',
                'winner6.jpg', 'winner7.jpg', 'winner8.jpg', 'winner9.jpg', 'winner10.jpg'
            ];
            
            const foundFiles = [];
            const foldersToCheck = ['./', './images/', './media/', './photos/', './videos/'];
            
            // Check multiple folders
            for (const folder of foldersToCheck) {
                for (const filename of commonNames) {
                    try {
                        const fullPath = `${folder}${filename}`;
                        const response = await fetch(fullPath, { method: 'HEAD' });
                        if (response.ok) {
                            foundFiles.push(fullPath);
                            console.log('Found file:', fullPath);
                        }
                    } catch (error) {
                        // File doesn't exist, continue
                    }
                }
            }
            
            return foundFiles;
        }

        // Get files from online folder
        async function getOnlineFolderFiles(baseUrl, fileList) {
            console.log('Checking online folder...');
            const foundFiles = [];
            
            for (const filename of fileList) {
                try {
                    const fullUrl = baseUrl + filename;
                    const response = await fetch(fullUrl, { method: 'HEAD' });
                    if (response.ok) {
                        foundFiles.push(fullUrl);
                        console.log('Found online file:', fullUrl);
                    }
                } catch (error) {
                    console.log('File not found:', filename);
                }
            }
            
            return foundFiles;
        }

        // Master auto-detection function
        async function autoDetectMedia() {
            console.log('Starting media detection...');
            let foundFiles = [];
            
            try {
                // Method 1: Try Google Drive if enabled
                if (CONFIG.googleDriveFolder.enabled && CONFIG.googleDriveFolder.apiKey !== "YOUR_GOOGLE_API_KEY") {
                    console.log('Trying Google Drive...');
                    foundFiles = await getGoogleDriveFiles(
                        CONFIG.googleDriveFolder.folderId, 
                        CONFIG.googleDriveFolder.apiKey
                    );
                    if (foundFiles.length > 0) {
                        console.log(`Found ${foundFiles.length} files from Google Drive`);
                        return foundFiles;
                    }
                }
                
                // Method 2: Try online folder if enabled
                if (CONFIG.onlineFolder.enabled) {
                    console.log('Trying online folder...');
                    foundFiles = await getOnlineFolderFiles(
                        CONFIG.onlineFolder.baseUrl,
                        CONFIG.onlineFolder.fileList
                    );
                    if (foundFiles.length > 0) {
                        console.log(`Found ${foundFiles.length} files from online folder`);
                        return foundFiles;
                    }
                }
                
                // Method 3: Try local auto-detection
                console.log('Trying local auto-detection...');
                foundFiles = await autoDetectLocalMedia();
                if (foundFiles.length > 0) {
                    console.log(`Found ${foundFiles.length} local files`);
                    return foundFiles;
                }
                
                // Method 4: Fallback to manual URLs
                if (CONFIG.manualUrls.length > 0) {
                    console.log('Using manual URL fallback...');
                    return CONFIG.manualUrls;
                }
                
                return [];
                
            } catch (error) {
                console.error('Error in auto-detection:', error);
                // Return manual URLs as final fallback
                return CONFIG.manualUrls;
            }
        }

        // Alternative: If you use a file input to select multiple files
        function setupFileInput() {
            // Create a hidden file input
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.multiple = true;
            fileInput.accept = 'image/*,video/*';
            fileInput.style.display = 'none';
            document.body.appendChild(fileInput);
            
            // Add a button to trigger file selection
            const selectButton = document.createElement('button');
            selectButton.textContent = 'Select Images/Videos';
            selectButton.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 10px 20px;
                background: rgba(0, 255, 255, 0.2);
                border: 1px solid #00ffff;
                color: #00ffff;
                border-radius: 5px;
                cursor: pointer;
                backdrop-filter: blur(10px);
                z-index: 1000;
            `;
            
            selectButton.addEventListener('click', () => {
                fileInput.click();
            });
            
            fileInput.addEventListener('change', (event) => {
                const files = Array.from(event.target.files);
                mediaFiles = files.map(file => URL.createObjectURL(file));
                console.log('Files selected:', mediaFiles.length);
                currentIndex = 0;
                if (mediaFiles.length > 0) {
                    showMedia();
                }
                selectButton.style.display = 'none'; // Hide button after selection
            });
            
            document.body.appendChild(selectButton);
        }

        // Check if file is video
        function isVideoFile(url) {
            const videoExtensions = ['.mp4', '.webm', '.ogg', '.mov', '.avi', '.mkv', '.m4v'];
            return videoExtensions.some(ext => url.toLowerCase().includes(ext));
        }

        // Create media element
        function createMediaElement(src) {
            const isVideo = isVideoFile(src);
            const element = document.createElement(isVideo ? 'video' : 'img');
            
            element.className = 'media-item';
            element.src = src;
            
            if (isVideo) {
                element.muted = true; // For autoplay to work
                element.autoplay = true;
                element.loop = true;
                element.playsInline = true;
                element.controls = false;
                mediaType.textContent = 'Video';
            } else {
                element.alt = 'Winner Image';
                mediaType.textContent = 'Photo';
                // Add crossorigin for external images
                if (src.startsWith('http')) {
                    element.crossOrigin = 'anonymous';
                }
            }
            
            return element;
        }

        // Show media with smooth transition
        function showMedia() {
            if (isTransitioning || mediaFiles.length === 0) return;

            isTransitioning = true;
            
            // Clear any existing timers
            if (countdownTimer) clearInterval(countdownTimer);
            if (progressTimer) clearInterval(progressTimer);

            const mediaFile = mediaFiles[currentIndex];
            console.log('Loading media:', mediaFile, 'Index:', currentIndex);

            // Create new media element
            const newMediaElement = createMediaElement(mediaFile);
            
            // Handle successful loading
            const handleLoad = () => {
                console.log('Media loaded successfully:', mediaFile);
                loadingOverlay.style.display = 'none';
                
                // Remove old media element
                if (currentMediaElement) {
                    currentMediaElement.classList.add('fade-out');
                    setTimeout(() => {
                        if (currentMediaElement && currentMediaElement.parentNode) {
                            currentMediaElement.parentNode.removeChild(currentMediaElement);
                        }
                    }, 800);
                }
                
                // Show new media
                newMediaElement.classList.add('active');
                currentMediaElement = newMediaElement;
                isTransitioning = false;
                
                // Start countdown
                startCountdown();
            };

            // Handle loading errors
            const handleError = (error) => {
                console.error('Failed to load media:', mediaFile, error);
                loadingOverlay.innerHTML = `<div style="color: #ff0080; text-align: center;">Failed to load: ${mediaFile}<br><small>Trying next item...</small></div>`;
                
                // Try next media after short delay
                setTimeout(() => {
                    loadingOverlay.innerHTML = '<div class="loading-spinner"></div>';
                    loadingOverlay.style.display = 'flex';
                    isTransitioning = false;
                    nextMedia();
                }, 2000);
            };

            // Show loading
            loadingOverlay.style.display = 'flex';
            loadingOverlay.innerHTML = '<div class="loading-spinner"></div>';
            
            // Add to display
            mediaDisplay.appendChild(newMediaElement);
            
            // Handle load events
            if (newMediaElement.tagName === 'VIDEO') {
                newMediaElement.addEventListener('canplay', handleLoad, { once: true });
                newMediaElement.addEventListener('error', handleError, { once: true });
                
                // Fallback timeout for videos
                setTimeout(() => {
                    if (isTransitioning && newMediaElement.readyState >= 2) {
                        handleLoad();
                    }
                }, 3000);
            } else {
                newMediaElement.addEventListener('load', handleLoad, { once: true });
                newMediaElement.addEventListener('error', handleError, { once: true });
                
                // Fallback timeout for images
                setTimeout(() => {
                    if (isTransitioning && newMediaElement.complete) {
                        handleLoad();
                    } else if (isTransitioning) {
                        handleError('Timeout');
                    }
                }, 5000);
            }
        }

        // Start countdown and progress
        function startCountdown() {
            let timeLeft = 10;
            let progressStep = 0;
            
            countdown.textContent = timeLeft + 's';
            progressFill.style.width = '0%';
            
            console.log('Starting countdown for:', mediaFiles[currentIndex]);
            
            // Update every 100ms for smooth progress
            progressTimer = setInterval(() => {
                progressStep += 100;
                const progressPercent = (progressStep / displayDuration) * 100;
                progressFill.style.width = Math.min(progressPercent, 100) + '%';
            }, 100);
            
            // Update countdown every second
            countdownTimer = setInterval(() => {
                timeLeft--;
                countdown.textContent = timeLeft + 's';
                
                if (timeLeft <= 0) {
                    clearInterval(countdownTimer);
                    clearInterval(progressTimer);
                    nextMedia();
                }
            }, 1000);
        }

        // Move to next media
        function nextMedia() {
            if (mediaFiles.length === 0) return;
            
            console.log('Moving to next media. Current index:', currentIndex, 'Total files:', mediaFiles.length);
            
            // Move to next index (loops back to 0 after last item)
            currentIndex = (currentIndex + 1) % mediaFiles.length;
            
            console.log('New index:', currentIndex);
            
            // Small delay for smooth transition
            setTimeout(() => {
                showMedia();
            }, 500);
        }

        // Initialize gallery with auto-detection
        async function initialize() {
            console.log('Initializing gallery...');
            
            // Show loading
            loadingOverlay.style.display = 'flex';
            loadingOverlay.innerHTML = '<div style="color: #00ffff; text-align: center; font-size: 1.2rem;">🔍 Auto-detecting media files...<br><div class="loading-spinner" style="margin-top: 1rem;"></div></div>';
            
            try {
                // Auto-detect media files
                mediaFiles = await autoDetectMedia();
                
                if (mediaFiles.length === 0) {
                    loadingOverlay.innerHTML = `
                        <div style="color: #ff0080; text-align: center; font-size: 1.2rem;">
                            📁 No media files found!<br>
                            <small style="color: #00ffff; margin-top: 1rem; display: block;">
                                Put your images in one of these locations:<br>
                                • Same folder as index.html (image1.jpg, image2.jpg, etc.)<br>
                                • ./images/ folder (image1.jpg, image2.jpg, etc.)<br>
                                • ./media/ folder (image1.jpg, image2.jpg, etc.)<br><br>
                                Or use the file selector button that will appear.
                            </small>
                        </div>
                    `;
                    
                    // Setup file input as fallback
                    setTimeout(() => {
                        setupFileInput();
                    }, 2000);
                    
                    return;
                }
                
                console.log(`Found ${mediaFiles.length} media files, starting slideshow...`);
                loadingOverlay.innerHTML = `
                    <div style="color: #00ff80; text-align: center; font-size: 1.2rem;">
                        ✅ Found ${mediaFiles.length} files!<br>
                        <small>Starting slideshow...</small>
                    </div>
                `;
                
                // Start slideshow after brief delay
                setTimeout(() => {
                    showMedia();
                }, 2000);
                
            } catch (error) {
                console.error('Error initializing:', error);
                loadingOverlay.innerHTML = `
                    <div style="color: #ff0080; text-align: center;">
                        ❌ Error detecting files<br>
                        <small>Check console for details</small>
                    </div>
                `;
                
                // Setup file input as fallback
                setTimeout(() => {
                    setupFileInput();
                }, 2000);
            }
        }

        // Handle page visibility (pause/resume videos when tab changes)
        document.addEventListener('visibilitychange', () => {
            if (currentMediaElement && currentMediaElement.tagName === 'VIDEO') {
                if (document.hidden) {
                    currentMediaElement.pause();
                } else {
                    currentMediaElement.play();
                }
            }
        });

        // Start the gallery
        initialize();
    </script>
</body>
</html>
